
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Understanding bitwise operations in JavaScript - Adam Mark</title>
  <meta name="author" content="Adam Mark">

  
  <meta name="description" content="I’ve been reading Code: The Hidden Language of Computer Hardware and Software
by Charles Petzold. It’s a great introduction to the building blocks of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.adammark.net/blog/2011/04/06/understanding-bitwise-operations-in-javascript/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Mark" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Mark</a></h1>
  
    <h2>Web design and development</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.adammark.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/work">My Work</a></li>
  <li><a href="/about">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Understanding Bitwise Operations in JavaScript</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-06T23:20:00-04:00" pubdate data-updated="true">Apr 6<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I’ve been reading <a href="http://amzn.com/0735611319">Code: The Hidden Language of Computer Hardware and Software</a>
by Charles Petzold. It’s a great introduction to the building blocks of
computer science—<em>ones and zeros</em>—for the liberal arts majors among us.
Check it out and you’ll understand this joke:</p>

<blockquote><p>There are only 10 kinds of people in the world: Those who understand binary
and those who don’t.</p></blockquote>

<p>When you’re done ROFLing, consider some of the ways you can use bitwise
operations in everyday JavaScript code:</p>

<h2>Use a bitmask to check for inclusion in a set</h2>

<p>Say you’ve got a bowl of five different fruits and you want to know if it
contains a banana. You could simply check every piece of fruit in the bowl to
see if it’s a banana:</p>

<pre><code>function contains(bowl, fruit) {
    for (var i = 0; i &lt; bowl.length; i++) {
        if (bowl[i] == fruit) {
            return true;
        }
    }

    return false;
}

// has banana? yes
contains(["apple", "banana", "cherry"], “banana”);
</code></pre>

<p>Or you could use <code>Array.indexOf</code> to get the same result:</p>

<pre><code>function contains(bowl, fruit) {
    return bowl.indexOf(fruit) &gt; -1;
}

// has banana? yes
contains(["apple", "banana", "cherry"], “banana”);

// has banana? no
contains(["apple", "grape", "cherry"], “banana”);
</code></pre>

<p>But what if you want to know whether the bowl contains a banana, a cherry and
an apple?</p>

<pre><code>var bowl = ["apple", "banana", "cherry", "grape", "peach"];

// has banana, cherry and apple? yes
contains(bowl, “banana”) &amp;&amp; contains(bowl, “cherry”) &amp;&amp; contains(bowl, “apple”);
</code></pre>

<p>This gets ugly fast. You could, of course, modify the <code>contains</code> function to
accept an array of fruits:</p>

<pre><code>function contains(bowl, fruits) {
    for (var i = 0; i &lt; fruits.length; i++) {
        if (bowl.indexOf(fruits[i]) == -1) {
            return false;
        }
    }

    return true;
}

var bowl = ["strawberry", "grape", "peach", "orange"];

var fruits = ["banana", "cherry", "apple"];

// has banana, cherry and apple? no
contains(bowl, fruits);
</code></pre>

<p>That’s better, but let’s try doing it without arrays and loops. Enter
bitmasks! First, assign each possible option a value of 2 to the power of n,
starting with n=0:</p>

<pre><code>var Fruit = {
    BANANA:       1,
    ORANGE:       2,
    STRAWBERRY:   4,
    PEACH:        8,
    APPLE:       16,
    GRAPE:       32,
    CHERRY:      64,
    TANGERINE:  128
};
</code></pre>

<p>Each decimal value converts to a binary sequence that contains exactly one
“1.” For example, ORANGE equals 10 and STRAWBERRY equals 100. Together they
equal 110:</p>

<pre><code>   010
OR 100
   —
   110
</code></pre>

<p>You can quickly calculate the sum of the bowl using a bitwise OR expression.
Say the bowl has a banana, a peach and a tangerine:</p>

<pre><code>var bowl = Fruit.BANANA | Fruit.PEACH | Fruit.TANGERINE;
</code></pre>

<p>This bowl equals 137 in decimal or 10001001 in binary. Notice the number of
ones in the result equals the number of fruits in the bowl:</p>

<pre><code>   00000001  BANANA
OR 00001000  PEACH
OR 10000000  TANGERINE
   ——–
   10001001
</code></pre>

<p>Now you can represent any configuration of eight fruits in just eight digits!</p>

<p>The resulting value, 10001001, will serve as a bitmask to determine whether
the bowl contains certain fruits. Testing for the presence of a single fruit
is straightforward with a bitwise AND:</p>

<pre><code>    10001001  BOWL
AND 00000001  BANANA
    ——–
    00000001  TRUE

    10001001  BOWL
AND 00000010  ORANGE
    ——–
    00000000  FALSE
</code></pre>

<p>Now just check to see if bowl AND fruit is greater than zero:</p>

<pre><code>function contains(bowl, fruit) {
    return (bowl &amp; fruit) &gt; 0;
}

var bowl = Fruit.BANANA | Fruit.PEACH | Fruit.TANGERINE;

// has banana? yes
contains(bowl, Fruit.BANANA);
</code></pre>

<p>Testing for the presence of multiple fruits is a bit trickier but just as
elegant. Since the ANDed value can be positive if just some of the fruits are
present, you need to make sure the ANDed value is greater than or equal to the
value of fruits itself:</p>

<pre><code>function contains(bowl, fruits) {
    return (bowl &amp; fruits) &gt;= fruits;
}

var bowl = Fruit.BANANA | Fruit.PEACH | Fruit.TANGERINE;

// has banana and tangerine? yes
contains(bowl, Fruit.BANANA | Fruit.TANGERINE);

// has banana and apple? no
contains(bowl, Fruit.BANANA | Fruit.APPLE);
</code></pre>

<p>See how the bitmask method performs against the array method at <a href="http://jsperf.com/array-search-vs-bitmask-search">jsperf.com</a>.</p>

<h2>Use bitwise AND for alternation</h2>

<p>You’ve probably used a <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#.25_.28Modulus.29">modulus</a> to test whether the value of a counter
is odd or even:</p>

<pre><code>for (var i = 0; i &lt; 10000; i++) {
    if (i % 2 == 0) {
        // even
    }
    else {
        // odd
    }
}
</code></pre>

<p>But in big loops it’s faster to use a binary AND expression. In binary, an
even number AND 1 is always 0 (even), while an odd number AND 1 is always 1
(odd):</p>

<pre><code>for (var i = 0; i &lt; 10000; i++) {
    if (i &amp; 1 == 0) {
        // even
    }
    else {
        // odd
    }
}
</code></pre>

<h2>Use bitwise shifting to convert hexadecimal values</h2>

<p>Did you ever wonder what “hex” (base 16) color values look like in another
number system? Take the value of pure red: FF0000. In decimal (base 10) it’s
16711680 and in binary (base 2) it’s 111111110000000000000000. Try it for
yourself in a JavaScript console:</p>

<pre><code>0xFF0000.toString(10);
0xFF0000.toString(2);
</code></pre>

<p>Now let’s say you want to convert the hex value to RGB, in which R, G and B
are values ranging from 0 to 255:</p>

<pre><code>function hexToRGB(hex) {
    var r = (hex &amp; 0xFF0000) &gt;&gt; 16;
    var g = (hex &amp; 0x00FF00) &gt;&gt; 8;
    var b = (hex &amp; 0x0000FF);
    return [r,g,b];
}
</code></pre>

<p>Here, the inputted value is being ANDed with the values of pure red, green and
blue, then the red and green values are shifted to the right by 16 bits and 8
bits, respectively. The result is three 8-bit values, or 0-255 in decimal.</p>

<p>Take the color gold: 0xFFCC00. What are the individual RGB values?</p>

<pre><code>// returns [255, 204, 0]
var rgb = hexToRGB(0xFFCC00);
</code></pre>

<p>And it works the other way around. For example, to create a hex string from
red, blue and green values:</p>

<pre><code>function rgbToHexString(r, g, b) {
    var color = (r &lt;&lt; 16) | (g &lt;&lt; 8) | b;
    return “#” + (“000000″ + color.toString(16)).substr(-6);
}

// returns “#ffcc00″
rgbToHexString(255, 204, 0);
</code></pre>

<p>As you can see, binary operations are useful for everyday JavaScript
programming tasks. And they’re super fast!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Adam Mark</span></span>

      








  


<time datetime="2011-04-06T23:20:00-04:00" pubdate data-updated="true">Apr 6<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.adammark.net/blog/2011/04/06/understanding-bitwise-operations-in-javascript/" data-via="" data-counturl="http://www.adammark.net/blog/2011/04/06/understanding-bitwise-operations-in-javascript/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/03/19/html5-in-a-flash/" title="Previous Post: HTML5 in a Flash!">&laquo; HTML5 in a Flash!</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/08/11/javascript-tricks-to-impress-your-friends/" title="Next Post: JavaScript tricks to impress your friends">JavaScript tricks to impress your friends &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/10/introducing-chartlets-tiny-charts-for-tablet-and-mobile-web-apps/">Introducing Chartlets: Tiny charts for tablet and mobile web apps</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/16/app-cloud-vs-phonegap/">App Cloud vs. PhoneGap: Which hybrid-native platform is right for you?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/15/opening-a-modal-email-window-in-app-cloud/">Opening a modal email window in App Cloud</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/20/monitoring-the-connection-state-in-app-cloud/">Monitoring the connection state in App Cloud</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/19/markup-dot-js-custom-pipes-for-your-piping-pleasure/">Markup.js: Custom pipes for your piping pleasure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/15/app-cloud-and-kinvey-a-one-two-punch-for-content-centric/">App Cloud and Kinvey: A one-two punch for content-centric, data-driven apps</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/24/getting-to-the-promised-land-of-cross-platform/">Getting to the promised land of cross-platform, device-independent displays</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/06/launching-external-apps-in-app-cloud/">Launching external apps in App Cloud</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/03/inside-the-app-cloud-workshop/">Inside the App Cloud Workshop: Understanding your apps in development mode</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/03/a-font-of-icons-for-your-app-cloud-app/">A font of icons for your App Cloud app</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Adam Mark -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
